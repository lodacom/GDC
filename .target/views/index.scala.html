@(regions: List[String],departements: List[String],villes: List[String],infoRegion: List[EntityInformation])

@main("Accueil") {
	<div id="map" style="width: 600px; height: 400px"></div>
	@if(infoRegion!=null){
		<div id="abstract">
		@infoRegion.get(0).getAbstract()<br/>
		</div>
		<!--  <div id="rsa">
		@infoRegion.get(0).getRSA2009()<br/>
		@infoRegion.get(0).getRSA2010()<br/>
		</div>-->
		<script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
          
    	  $.post("/search",{ }, function(response){
        var data = google.visualization.arrayToDataTable([
          ['Années', 'Nombre de personnes soumises à l\'ISF', 'Nombre de personnes percevant le RSA'],
          ['2002', response[0].isfInfo.nbre_redev , 			600],
          ['2008', response[1].isfInfo.nbre_redev,				600],
          ['2009',  600,      									response[0].rsa2009],
          ['2010',  600,      									response[0].rsa2010]
        ]);

        var options = {
                title: 'L\'écart entre la richesse et la pauvreté'
              };

              var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
              chart.draw(data, options);
    	  });
    	  
        
      }
    </script>
		 <div id="chart_div" style="width: 900px; height: 500px;"></div>
		
	}
	<form method="post" action="">
		<label id="region">Régions:</label>
		<select name="regions" id="regions">
			<option value="regions">Régions</option>
			@for(region <- regions) {
				<option value=@region>@region</option>
			}
		</select>
		<input type="radio" name="radio_zone" id="radio_region" value="radio_region"/><br/>
		<label id="departement">Départements:</label>
		<select name="departements" id="departements">
			<option value="departements">Départements</option>
			@for(departement <- departements) {
				<option value=@departement>@departement</option>
			}
		</select>
		<input type="radio" name="radio_zone" id="radio_departement" value="radio_departement"/><br/>
		<label id="ville">Villes:</label>
		<select name="villes" id="villes">
			<option value="villes">Villes</option>
			@for(ville <- villes) {
				<option value=@ville>@ville</option>
			}
		</select>
		<input type="radio" name="radio_zone" id="radio_ville" value="radio_ville"/><br/>
		<label>Voisins:</label><input type="checkbox" name="voisin" id="voisin"/><br/>
	<input type="submit" value="Cherchez les riches"/>
	</form>
	  <script>
		var map = L.map('map').setView([ 46, -2 ], 5);
		L.tileLayer(
						'http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png',
						{
							maxZoom : 18,
							attribution : 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery � <a href="http://cloudmade.com">CloudMade</a>'
						}).addTo(map);
		
		$.post("/search",{ }, function(response){
			//ERREUR
      		if(typeof response == 'string') alert(response);
      		//CAS NORMAL
      		else{  
      			var marker = L.marker([response[0].gInfo.latitude , response[0].gInfo.longitude]).addTo(map);
      			marker.bindPopup("<b>Nom de l'entité: </b>"+response[0].isfInfo.entite+"<br/><b>Nom du chef-lieu/ville: </b>"
      	      			+response[0].isfInfo.nom_commune+"</br>Nombre d'habitants :"+response[0].gInfo.population+"<br/>"
      	      			+"Nombre de redevables à l'ISF 2002: "+response[0].isfInfo.nbre_redev+"<br/>"
      	      			+"Nombre de redevables à l'ISF 2008: "+response[1].isfInfo.nbre_redev+"<br/>"
      	      			+"Impot moyen 2002: "+response[0].isfInfo.impot_moyen+"<br/>"
      	      			+"Impot moyen 2008: "+response[1].isfInfo.impot_moyen+"<br/>"
      	      			+"Patrimoine moyen 2002: "+response[0].isfInfo.patrimoine_moyen+"<br/>"
      	      			+"Patrimoine moyen 2008: "+response[1].isfInfo.patrimoine_moyen+"<br/>");
      		}
			});
	</script>
}
